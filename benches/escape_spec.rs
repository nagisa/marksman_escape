#![feature(test)]
extern crate test;
extern crate marksman_escape;

use test::Bencher;
use test::black_box;
use marksman_escape::Escaped;

static ALL_ESCAPES_SHORT : &'static str = r##"<><><><><><><><><><><><><><><><><><><><><><><><><><><
><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>"##;

static ALL_ESCAPES_LONG : &'static str = "\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}
\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}\u{A0}{}";

#[bench]
fn escape_spec_short(b: &mut Bencher){
    b.bytes = ALL_ESCAPES_SHORT.len() as u64;
    b.iter(||{
        for _ in Escaped::new(ALL_ESCAPES_SHORT) {
            black_box(());
        }
    });
}


#[bench]
fn escape_spec_long(b: &mut Bencher){
    b.bytes = ALL_ESCAPES_LONG.len() as u64;
    b.iter(||{
        for _ in Escaped::new(ALL_ESCAPES_LONG) {
            black_box(());
        }
    });
}
